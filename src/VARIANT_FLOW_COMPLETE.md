# Complete Variant System Flow

## User Journey: Purchasing a Product with Variants

### Step 1: Product Details Page
**User sees variant options and selects one**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Premium Cotton T-Shirt                                  â”‚
â”‚  â­â­â­â­â­ (128 reviews)                                  â”‚
â”‚                                                          â”‚
â”‚  Special Price: â‚¹499  ~~â‚¹999~~  Save â‚¹500               â”‚
â”‚                                                          â”‚
â”‚  ğŸ“ Select Size (M)                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ S  â”‚ â”‚ Mâœ“ â”‚ â”‚ L  â”‚ â”‚ XL â”‚                           â”‚
â”‚  â”‚    â”‚ â”‚    â”‚ â”‚    â”‚ â”‚â‚¹549â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                          â”‚
â”‚  [ğŸ›’ Buy Now]  [Share]                                  â”‚
â”‚                                                          â”‚
â”‚  âš ï¸  Only 60 items left in stock!                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**What Happens:**
- User clicks "M" size variant
- Price updates to â‚¹499 (M variant price)
- Stock shows 60 items (M variant stock)
- Selected variant highlighted with checkmark
- Click "Buy Now" â†’ Goes to Checkout

---

### Step 2: Checkout Page
**User sees selected variant and completes purchase**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Order Summary                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [Img] Premium Cotton T-Shirt                       â”‚ â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚ â”‚
â”‚  â”‚       â”‚ğŸ“ Size: M    â”‚ (variant badge)            â”‚ â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚ â”‚
â”‚  â”‚       â‚¹499                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â”‚  Quantity: [âˆ’] 2 [+]                                     â”‚
â”‚  60 items available                                      â”‚
â”‚                                                          â”‚
â”‚  Subtotal      â‚¹998                                      â”‚
â”‚  Delivery      FREE                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚
â”‚  Total Amount  â‚¹998                                      â”‚
â”‚                                                          â”‚
â”‚  [ğŸ”’ Place Order]                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**What Happens:**
- Variant badge shows "Size: M"
- Price calculation uses â‚¹499 (M variant price)
- Quantity limited to 60 (M variant stock)
- Click "Place Order" â†’ Creates order with variant info

**Order Data Sent to Backend:**
```json
{
  "productId": 11,
  "productName": "Premium Cotton T-Shirt",
  "quantity": 2,
  "addressId": "1",
  "subtotal": 998,
  "shipping": 0,
  "total": 998,
  "variantId": "m",
  "variantLabel": "M",
  "variantType": "size"
}
```

---

### Step 3: Order Confirmation
**User receives confirmation**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… Order placed successfully! ğŸ‰                        â”‚
â”‚                                                          â”‚
â”‚  Order ID: ORD002                                        â”‚
â”‚  Estimated Delivery: 5-7 business days                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Step 4: My Orders Page
**User can view order with variant details**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  My Orders                                               â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [Img] Premium Cotton T-Shirt                       â”‚ â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚ â”‚
â”‚  â”‚       â”‚ğŸ“ Size: M    â”‚ (indigo badge)             â”‚ â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚ â”‚
â”‚  â”‚       Order ID: ORD002                             â”‚ â”‚
â”‚  â”‚                                      â‚¹499          â”‚ â”‚
â”‚  â”‚                                      Qty: 2        â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚  âœ… Delivered  ğŸ“… on 12 Oct, 2025                 â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚  [ğŸ’¬ Review Product]                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**What's Displayed:**
- Product name with variant badge
- Variant-specific price (â‚¹499 for Size M)
- Quantity ordered (2)
- Delivery status
- Option to review

---

## Multiple Variant Types Examples

### Weight Variant (Groceries)

**Product Details:**
```
Organic Basmati Rice
âš–ï¸  Select Weight (1 kg)

[1 kgâœ“]  [5 kg]   [10 kg]  [25 kg]
 â‚¹180     â‚¹850    â‚¹1,650   â‚¹3,999

Stock: 200 items available
```

**Checkout:**
```
Order Summary
[Img] Organic Basmati Rice
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚âš–ï¸  Weight: 5 kg â”‚ (green badge)
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â‚¹850
```

**My Orders:**
```
[Img] Organic Basmati Rice
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚âš–ï¸  Weight: 5 kg â”‚ (green badge)
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Order ID: ORD003
                  â‚¹850
```

---

### Quantity Variant (Pack Sizes)

**Product Details:**
```
Stainless Steel Water Bottle
ğŸ“¦ Select Quantity (Pack of 1)

[Pack of 1âœ“]  [Pack of 2]  [Pack of 4]
    â‚¹399         â‚¹749        â‚¹1,399

Stock: 150 items available
```

**Checkout:**
```
Order Summary
[Img] Stainless Steel Water Bottle
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ğŸ“¦ Pack of 4  â”‚ (purple badge)
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â‚¹1,399
```

**My Orders:**
```
[Img] Stainless Steel Water Bottle
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ğŸ“¦ Pack of 4  â”‚ (purple badge)
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Order ID: ORD004
              â‚¹1,399
```

---

## Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Product Details â”‚
â”‚   Select: M     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ onBuyNow(variant)
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    App.tsx      â”‚
â”‚ setSelectedVariant
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Pass variant
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Checkout Page  â”‚
â”‚  Display: M     â”‚
â”‚  Price: â‚¹499    â”‚
â”‚  Stock: 60      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ handleCheckout()
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend API    â”‚
â”‚  POST /orders   â”‚
â”‚  with variant   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Order Created
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Orders Page    â”‚
â”‚  GET /orders    â”‚
â”‚  Display variantâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## State Management

### App.tsx State
```typescript
const [selectedProduct, setSelectedProduct] = useState<Product | null>(null);
const [selectedVariant, setSelectedVariant] = useState<ProductVariant | null>(null);

// When user clicks Buy Now from ProductDetails
const handleBuyNowFromDetails = (variant?: ProductVariant) => {
  setSelectedVariant(variant || null);
  setCurrentPage('checkout');
};

// Clear on back navigation
const handleBack = () => {
  setCurrentPage('home');
  setSelectedProduct(null);
  setSelectedVariant(null);
};
```

### ProductDetails.tsx State
```typescript
const defaultVariant = product.variants?.find(v => v.isDefault) || product.variants?.[0];
const [selectedVariant, setSelectedVariant] = useState<ProductVariant | undefined>(defaultVariant);

// Update price/stock based on selected variant
const currentPrice = selectedVariant?.price ?? product.price;
const currentStock = selectedVariant?.stock ?? product.stock;
```

### CheckoutPage.tsx Props
```typescript
interface CheckoutPageProps {
  product: Product;
  selectedVariant?: ProductVariant | null;
  // ... other props
}

// Use variant price for calculations
const currentPrice = selectedVariant?.price ?? product.price;
const currentStock = selectedVariant?.stock ?? product.stock;
const subtotal = currentPrice * quantity;
```

---

## Variant Badge Color System

| Type     | Border      | Background | Text       | Use Case |
|----------|-------------|------------|------------|----------|
| Size     | indigo-300  | indigo-50  | indigo-700 | Clothing, Shoes |
| Weight   | green-300   | green-50   | green-700  | Groceries, Food |
| Quantity | purple-300  | purple-50  | purple-700 | Pack Sizes |
| Color    | gray-300    | gray-50    | gray-700   | Future Use |

---

## Key Features

### âœ… Implemented
1. Variant selection in Product Details
2. Real-time price updates
3. Real-time stock updates
4. Visual feedback (checkmarks, borders)
5. Variant display in Checkout
6. Variant in order creation
7. Variant badges in Orders page
8. Color-coded by type
9. Contextual icons
10. Out-of-stock handling

### ğŸš€ Future Enhancements
1. Image switching based on variant
2. Variant combinations (Size + Color)
3. Bulk pricing for quantity variants
4. Variant comparison tables
5. Quick variant change in cart
6. Variant filters in order history
7. Reorder with variant pre-selection

---

## Summary

The variant system is now **fully functional** across all major pages:

- **Product Details**: Select variant â†’ See updated price/stock
- **Checkout**: Review variant â†’ Complete purchase
- **Orders**: View variant â†’ Identify exact product ordered

This provides a complete, professional e-commerce experience for products with multiple options! ğŸ‰
